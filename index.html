<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="styles.css" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <title>Tic Tac Toe</title>
  </head>

  <script>
    let arr = [];

    function check(player) {
      if (!arr.includes(player.id)) {
        // check if there is X/O in table
        if (arr.length > 0) {
          if (document.getElementById(arr[arr.length - 1]).value == "X") {
            document.getElementById(player.id).value = "O";
            document.getElementById(player.id).style.backgroundColor =
              "#b3d9ff";
          }
          if (document.getElementById(arr[arr.length - 1]).value == "O") {
            document.getElementById(player.id).value = "X";
            document.getElementById(player.id).style.backgroundColor =
              "#ff9999";
          }
        } else {
          // only if table empty
          document.getElementById(player.id).value = "X";
          document.getElementById(player.id).style.backgroundColor = "#ff9999";
        }

        arr.push(player.id);
      }

      const b1 = document.getElementById("b1").value;
      const b2 = document.getElementById("b2").value;
      const b3 = document.getElementById("b3").value;
      const b4 = document.getElementById("b4").value;
      const b5 = document.getElementById("b5").value;
      const b6 = document.getElementById("b6").value;
      const b7 = document.getElementById("b7").value;
      const b8 = document.getElementById("b8").value;
      const b9 = document.getElementById("b9").value;

      if (
        (b1 == "X" && b2 == "X" && b3 == "X") ||
        (b4 == "X" && b5 == "X" && b6 == "X") ||
        (b7 == "X" && b8 == "X" && b9 == "X") ||
        (b1 == "X" && b4 == "X" && b7 == "X") ||
        (b2 == "X" && b5 == "X" && b8 == "X") ||
        (b3 == "X" && b6 == "X" && b9 == "X") ||
        (b1 == "X" && b5 == "X" && b9 == "X") ||
        (b3 == "X" && b5 == "X" && b7 == "X")
      ) {
        alert("Player X won!");
        location.reload();
      } else if (
        (b1 == "O" && b2 == "O" && b3 == "O") ||
        (b4 == "O" && b5 == "O" && b6 == "O") ||
        (b7 == "O" && b8 == "O" && b9 == "O") ||
        (b1 == "O" && b4 == "O" && b7 == "O") ||
        (b2 == "O" && b5 == "O" && b8 == "O") ||
        (b3 == "O" && b6 == "O" && b9 == "O") ||
        (b1 == "O" && b5 == "O" && b9 == "O") ||
        (b3 == "O" && b5 == "O" && b7 == "O")
      ) {
        alert("Player O won!");
        location.reload();
      } else if (arr.length == 9) {
        alert("It's a tie!");
        location.reload();
      }
    }

    function undo() {
      if (arr.length > 0) {
        document.getElementById(arr[arr.length - 1]).value = "";
        document.getElementById(arr[arr.length - 1]).style.backgroundColor = "";

        arr = arr.filter((obj) => obj != arr[arr.length - 1]);
      }
    }
  </script>

  <body>
    <div class="layout">
      <input type="button" id="b1" onclick="check(b1)" />
      <input type="button" id="b2" onclick="check(b2)" />
      <input type="button" id="b3" onclick="check(b3)" />
    </div>
    <div class="layout">
      <input type="button" id="b4" onclick="check(b4)" />
      <input type="button" id="b5" onclick="check(b5)" />
      <input type="button" id="b6" onclick="check(b6)" />
    </div>
    <div class="layout">
      <input type="button" id="b7" onclick="check(b7)" />
      <input type="button" id="b8" onclick="check(b8)" />
      <input type="button" id="b9" onclick="check(b9)" />
    </div>

    <button onclick="undo()">Undo</button>
    <button onclick="location.reload()">New Game</button>
  </body>
</html>
