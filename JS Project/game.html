<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" href="styles.css">
    <meta name="viewport" content="width=device-width, initial-scale=0.75">
    <title>Tic Tac Toe</title>
  </head>

  <script>
    let arr=[], status=false;

      function check(x) {
        if (!arr.includes(x.id)) {
          if (arr.length!=0) {// check if there is X/O in table
            if(document.getElementById(arr[arr.length-1]).value=='X') {
              document.getElementById(x.id).value='O';
              document.getElementById(x.id).style.backgroundColor='#b3d9ff';
            }
            if (document.getElementById(arr[arr.length-1]).value=='O') {
              document.getElementById(x.id).value='X';
              document.getElementById(x.id).style.backgroundColor='#ff9999';
            }
          } else {// only if table empty
            document.getElementById(x.id).value='X';
            document.getElementById(x.id).style.backgroundColor='#ff9999';
          }

          arr.push(x.id);
        }

        const b1= document.getElementById("b1").value;
        const b2= document.getElementById("b2").value;
        const b3= document.getElementById("b3").value;
        const b4= document.getElementById("b4").value;
        const b5= document.getElementById("b5").value;
        const b6= document.getElementById("b6").value;
        const b7= document.getElementById("b7").value;
        const b8= document.getElementById("b8").value;
        const b9= document.getElementById("b9").value;

        if ((b1=='X' && b2=='X' && b3=='X') || (b4=='X' && b5=='X' && b6=='X') || (b7=='X' && b8=='X' && b9=='X') || (b1=='X' && b4=='X' && b7=='X') ||
          (b2=='X' && b5=='X' && b8=='X') || (b3=='X' && b6=='X' && b9=='X') || (b1=='X' && b5=='X' && b9=='X') || (b3=='X' && b5=='X' && b7=='X')) {
          alert("Player X won!");
          status=true;
          location.reload();
        }
        if ((b1=='O' && b2=='O' && b3=='O') || (b4=='O' && b5=='O' && b6=='O') || (b7=='O' && b8=='O' && b9=='O') || (b1=='O' && b4=='O' && b7=='O') ||
          (b2=='O' && b5=='O' && b8=='O') || (b3=='O' && b6=='O' && b9=='O') || (b1=='O' && b5=='O' && b9=='O') || (b3=='O' && b5=='O' && b7=='O')) {
          alert("Player O won!");
          status=true;
          location.reload();
        }

        if (arr.length==9 && status==false) {
          alert("It's a tie!");
          location.reload();
        }
      }

    function undo() {
      document.getElementById(arr[arr.length-1]).value='';
      document.getElementById(arr[arr.length-1]).style.backgroundColor='';

      arr= arr.filter(x=> x!=arr[arr.length-1]);
    }
  </script>

  <body>
    <input type="text" id="b1" onclick="check(b1)" value="" readonly>
    <input type="text" id="b2" onclick="check(b2)" value="" readonly>
    <input type="text" id="b3" onclick="check(b3)" value="" readonly><br><br>
    <input type="text" id="b4" onclick="check(b4)" value="" readonly>
    <input type="text" id="b5" onclick="check(b5)" value="" readonly>
    <input type="text" id="b6" onclick="check(b6)" value="" readonly><br><br>
    <input type="text" id="b7" onclick="check(b7)" value="" readonly>
    <input type="text" id="b8" onclick="check(b8)" value="" readonly>
    <input type="text" id="b9" onclick="check(b9)" value="" readonly><br><br>

    <input type="button" class="button" value="Undo" onclick="undo()">
    <input type="button" class="button" value="New Game" onclick="location.reload()">
  </body>
</html>
